const express = require("express");
const {
  createPentesting,
  getAllPentestings,
  getPentestingDetails,
  deletePentesting,
  updatePentesting
} = require("../controllers/pentestingController");
const { isAuthenticatedUser, authorizeRoles } = require("../middleware/auth");

const router = express.Router();

router.route("/pentestings").get(getAllPentestings);

router
  .route("/admin/meeting/new")
  .post(createPentesting);

router
  .route("/admin/pentesting/:id")
  .put(isAuthenticatedUser, authorizeRoles("admin"), updatePentesting)
  .delete(isAuthenticatedUser, authorizeRoles("admin"), deletePentesting);

router.route("/pentesting/:id").get(getPentestingDetails);

module.exports = router;
